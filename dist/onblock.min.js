!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("OnBlock",[],n):"object"==typeof exports?exports.OnBlock=n():t.OnBlock=n()}(window,function(){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(o,r,function(n){return t[n]}.bind(null,r));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=3)}([function(t,n){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(t,n){t.exports=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}},function(t,n){function e(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}},function(t,n,e){var o,r,i;r=[e(4)],void 0===(i="function"==typeof(o=function(n){"use strict";var o=e(0),r=new((n=o(n)).default);t.exports=r})?o.apply(n,r):o)||(t.exports=i)},function(t,n,e){var o,r,i;r=[n,e(5),e(9),e(1),e(2),e(13),e(16),e(24)],void 0===(i="function"==typeof(o=function(t,n,o,r,i,c,u,a){"use strict";var s=e(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n=s(n),o=s(o),r=s(r),i=s(i),c=s(c),u=s(u);var f=(a=s(a)).default.nodes.reduce(function(t,n){return t[n.name]=n,t},{}),l={},p=function(t){var n=t.source,e=t.data;if(window.parent===n&&e&&null!=e.actionId&&l[e.actionId]){var o=l[e.actionId];e.pending?o.emit("pending",e.pending):(e.success?o.emit("success",e.success):e.failed&&o.emit("failed",e.failed),delete l[e.actionId])}},d=function(){function t(n){(0,r.default)(this,t),this.pack=null,this.iost=null,this.rpc=null,this.account=null,this.network=null,window.addEventListener("message",p)}return(0,i.default)(t,[{key:"isInOnBlock",value:function(t){var n="";if(t)try{n=new URL(t).hostname}catch(t){console.log(t)}this.onblockUrl=t||a.default.onblockUrl;var e=[].concat((0,o.default)(a.default.onblockUrls),[n]),r=window.location!=window.parent.location?document.referrer:document.location.href;return e.indexOf(new URL(r).hostname)>-1}},{key:"newIOST",value:function(t){if(!t)throw"need IOST";if(!this.account)throw"need enable";return t.IOST.prototype.signAndSend=function(t){var n=document.domain,e=(0,c.default)(),o=new u.default;return l[e]=o,this.account?top.postMessage({action:"TX_ASK",actionId:e,data:{domain:n,tx:t,chain:"iost"}},this.onblockUrl):o.delay(0).emit("failed",{type:"err",message:"no account"}),o}.bind(this),this.pack=t,this.iost=new t.IOST(a.default.defaultConfig),this.rpc=new t.RPC(new t.HTTPProvider(f[this.network||"MAINNET"].url)),this.iost.setRPC(this.rpc),this.iost.setAccount(this.iost.account),this.iost.account=new t.Account(this.account.name),this.iost.rpc=this.rpc,this.iost}},{key:"enable",value:function(){var t=this;return new Promise(function(n,e){if(t.account)n(t.account.name);else{var o=(0,c.default)(),r=new u.default;l[o]=r,r.once("success",function(e){t.account=e.account,t.network=e.account.network,n(t.account.name)}).once("failed",e),top.postMessage({action:"GET_ACCOUNT",actionId:o,data:null},t.onblockUrl)}})}},{key:"getOnBlockAccountInfo",value:function(){var t=this;return new Promise(function(n,e){if(!t.account)return e("no account");var o=(0,c.default)(),r=new u.default;l[o]=r,r.on("success",function(t){return n({balances:t})}).on("failed",e),top.postMessage({action:"GET_OnBlock_ACCOUNT_INFO",actionId:o,data:{account:t.account}},t.onblockUrl)})}},{key:"newEOS",value:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.default.eosNetwork,r="".concat(o.protocol,"://").concat(o.host).concat(o.port?":":"").concat(o.port),i=function(t){return new Promise(function(n,o){if(!e.account)return o({type:"err",message:"no account"});var r=document.domain,i=(0,c.default)(),a=new u.default;l[i]=a,a.on("success",n).on("failed",o);var s={actions:t};top.postMessage({action:"TX_ASK",actionId:i,data:{domain:r,tx:s,chain:"eos"}},e.onblockUrl)})},s=function(t,e){var o=(0,n.default)(t,4),r=o[0],c=o[1],u=o[2],a=o[3];return i([{account:e,name:"transfer",data:{from:r,to:c,quantity:u,memo:a}}])},f=function(t){var e=(0,n.default)(t,1),o=e[0].actions,r=void 0===o?[]:o,c=r.map(function(t){var n=t.account,e=t.name,o=t.data;return{account:n,name:e,data:o}});return i(c)};return new Proxy(t({httpEndpoint:r,chainId:o.chainId}),{get:function(t,n){return"function"!=typeof t[n]?t[n]:function(){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return"transfer"===n?s(o,"eosio.token"):"transaction"===n?f(o):new Promise(function(e,r){t[n].apply(t,o).then(function(t){if(!t.hasOwnProperty("fc"))return e(t);var n=o[0];e(new Proxy(t,{get:function(t,e){return"then"===e?t[e]:function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];if("transfer"===e)return s(o,n);if("transaction"===e)return f(o);var c=o[0];return i([{account:n,name:e,data:c}])}}}))})})}}})}}]),t}();t.default=d})?o.apply(n,r):o)||(t.exports=i)},function(t,n,e){var o=e(6),r=e(7),i=e(8);t.exports=function(t,n){return o(t)||r(t,n)||i()}},function(t,n){t.exports=function(t){if(Array.isArray(t))return t}},function(t,n){t.exports=function(t,n){var e=[],o=!0,r=!1,i=void 0;try{for(var c,u=t[Symbol.iterator]();!(o=(c=u.next()).done)&&(e.push(c.value),!n||e.length!==n);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return e}},function(t,n){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,n,e){var o=e(10),r=e(11),i=e(12);t.exports=function(t){return o(t)||r(t)||i()}},function(t,n){t.exports=function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}},function(t,n){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,n){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,n,e){var o=e(14),r=e(15);t.exports=function(t,n,e){var i=n&&e||0;"string"==typeof t&&(n="binary"===t?new Array(16):null,t=null);var c=(t=t||{}).random||(t.rng||o)();if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,n)for(var u=0;u<16;++u)n[i+u]=c[u];return n||r(c)}},function(t,n){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var o=new Uint8Array(16);t.exports=function(){return e(o),o}}else{var r=new Array(16);t.exports=function(){for(var t,n=0;n<16;n++)0==(3&n)&&(t=4294967296*Math.random()),r[n]=t>>>((3&n)<<3)&255;return r}}},function(t,n){for(var e=[],o=0;o<256;++o)e[o]=(o+256).toString(16).substr(1);t.exports=function(t,n){var o=n||0,r=e;return[r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]]].join("")}},function(t,n,e){var o,r,i;r=[n,e(1),e(2),e(17),e(20),e(21),e(23)],void 0===(i="function"==typeof(o=function(t,n,o,r,i,c,u){"use strict";var a=e(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n=a(n),o=a(o),r=a(r),i=a(i),c=a(c);var s=function(t){function e(){var t;return(0,n.default)(this,e),(t=(0,r.default)(this,(0,i.default)(e).call(this))).task=[],t.task.push(function(){return t.next()}),setTimeout(function(){return t.next()},0),t}return(0,c.default)(e,t),(0,o.default)(e,[{key:"delay",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.task.push(function(){return setTimeout(function(){return t.next()},n)}),this}},{key:"send",value:function(t,n){var e=this;return this.task.push(function(){e.emit(t,n),e.next()}),this}},{key:"next",value:function(){var t=this.task.shift();t&&t()}}]),e}((u=a(u)).default);t.default=s})?o.apply(n,r):o)||(t.exports=i)},function(t,n,e){var o=e(18),r=e(19);t.exports=function(t,n){return!n||"object"!==o(n)&&"function"!=typeof n?r(t):n}},function(t,n){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(n){return"function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?t.exports=o=function(t){return e(t)}:t.exports=o=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)},o(n)}t.exports=o},function(t,n){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,n){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e(n)}t.exports=e},function(t,n,e){var o=e(22);t.exports=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&o(t,n)}},function(t,n){function e(n,o){return t.exports=e=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},e(n,o)}t.exports=e},function(t,n,e){"use strict";var o=Object.prototype.hasOwnProperty,r="~";function i(){}function c(t,n,e){this.fn=t,this.context=n,this.once=e||!1}function u(t,n,e,o,i){if("function"!=typeof e)throw new TypeError("The listener must be a function");var u=new c(e,o||t,i),a=r?r+n:n;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],u]:t._events[a].push(u):(t._events[a]=u,t._eventsCount++),t}function a(t,n){0==--t._eventsCount?t._events=new i:delete t._events[n]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,n,e=[];if(0===this._eventsCount)return e;for(n in t=this._events)o.call(t,n)&&e.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},s.prototype.listeners=function(t){var n=r?r+t:t,e=this._events[n];if(!e)return[];if(e.fn)return[e.fn];for(var o=0,i=e.length,c=new Array(i);o<i;o++)c[o]=e[o].fn;return c},s.prototype.listenerCount=function(t){var n=r?r+t:t,e=this._events[n];return e?e.fn?1:e.length:0},s.prototype.emit=function(t,n,e,o,i,c){var u=r?r+t:t;if(!this._events[u])return!1;var a,s,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,n),!0;case 3:return f.fn.call(f.context,n,e),!0;case 4:return f.fn.call(f.context,n,e,o),!0;case 5:return f.fn.call(f.context,n,e,o,i),!0;case 6:return f.fn.call(f.context,n,e,o,i,c),!0}for(s=1,a=new Array(l-1);s<l;s++)a[s-1]=arguments[s];f.fn.apply(f.context,a)}else{var p,d=f.length;for(s=0;s<d;s++)switch(f[s].once&&this.removeListener(t,f[s].fn,void 0,!0),l){case 1:f[s].fn.call(f[s].context);break;case 2:f[s].fn.call(f[s].context,n);break;case 3:f[s].fn.call(f[s].context,n,e);break;case 4:f[s].fn.call(f[s].context,n,e,o);break;default:if(!a)for(p=1,a=new Array(l-1);p<l;p++)a[p-1]=arguments[p];f[s].fn.apply(f[s].context,a)}}return!0},s.prototype.on=function(t,n,e){return u(this,t,n,e,!1)},s.prototype.once=function(t,n,e){return u(this,t,n,e,!0)},s.prototype.removeListener=function(t,n,e,o){var i=r?r+t:t;if(!this._events[i])return this;if(!n)return a(this,i),this;var c=this._events[i];if(c.fn)c.fn!==n||o&&!c.once||e&&c.context!==e||a(this,i);else{for(var u=0,s=[],f=c.length;u<f;u++)(c[u].fn!==n||o&&!c[u].once||e&&c[u].context!==e)&&s.push(c[u]);s.length?this._events[i]=1===s.length?s[0]:s:a(this,i)}return this},s.prototype.removeAllListeners=function(t){var n;return t?(n=r?r+t:t,this._events[n]&&a(this,n)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s},function(t,n,e){var o,r,i;r=[n],void 0===(i="function"==typeof(o=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={defaultConfig:{gasRatio:1,gasLimit:1e5,delay:0,expiration:90,defaultLimit:"unlimited"},nodes:[{name:"MAINNET",url:"https://api.iost.io",chain_id:1024,default:!0},{name:"TESTNET",url:"https://test.api.iost.io",chain_id:1023,default:!0}],onblockUrl:"https://onblock.me",onblockUrls:["onblock.me","onblock.com"],eosNetwork:{blockchain:"eos",host:"proxy.eosnode.tools",port:443,protocol:"https",chainId:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906"}};t.default=n})?o.apply(n,r):o)||(t.exports=i)}])});